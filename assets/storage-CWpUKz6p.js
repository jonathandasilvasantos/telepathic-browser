const a={zhipu:{name:"Zhipu AI",baseUrl:"https://api.z.ai/api/paas/v4",apiKeyUrl:"z.ai",models:[{id:"glm-4.7",name:"GLM-4.7",contextLength:2e5,supportsVision:!1},{id:"glm-4.7-flash",name:"GLM-4.7 Flash",contextLength:2e5,supportsVision:!1},{id:"glm-4.6v",name:"GLM-4.6V",contextLength:128e3,supportsVision:!0}]},openai:{name:"OpenAI",baseUrl:"https://api.openai.com/v1",apiKeyUrl:"platform.openai.com",models:[{id:"gpt-5.2",name:"GPT-5.2",contextLength:4e5,supportsVision:!0},{id:"gpt-5",name:"GPT-5",contextLength:4e5,supportsVision:!0},{id:"gpt-5-mini",name:"GPT-5 Mini",contextLength:4e5,supportsVision:!0},{id:"gpt-5-nano",name:"GPT-5 Nano",contextLength:4e5,supportsVision:!0},{id:"gpt-4.1",name:"GPT-4.1",contextLength:1047576,supportsVision:!0},{id:"gpt-4.1-mini",name:"GPT-4.1 Mini",contextLength:1047576,supportsVision:!0},{id:"o3",name:"o3",contextLength:2e5,supportsVision:!0},{id:"o4-mini",name:"o4-mini",contextLength:2e5,supportsVision:!0}]},gemini:{name:"Google Gemini",baseUrl:"https://generativelanguage.googleapis.com/v1beta/openai",apiKeyUrl:"aistudio.google.com",models:[{id:"gemini-3-pro-preview",name:"Gemini 3 Pro",contextLength:1048576,supportsVision:!0},{id:"gemini-3-flash-preview",name:"Gemini 3 Flash",contextLength:1048576,supportsVision:!0},{id:"gemini-2.5-pro",name:"Gemini 2.5 Pro",contextLength:1048576,supportsVision:!0},{id:"gemini-2.5-flash",name:"Gemini 2.5 Flash",contextLength:1048576,supportsVision:!0}]},kimi:{name:"Kimi (Moonshot)",baseUrl:"https://api.moonshot.ai/v1",apiKeyUrl:"platform.moonshot.ai",models:[{id:"kimi-k2.5",name:"Kimi K2.5",contextLength:262144,supportsVision:!0},{id:"moonshot-v1-128k",name:"Moonshot v1 128K",contextLength:128e3,supportsVision:!1}]},minimax:{name:"MiniMax",baseUrl:"https://api.minimax.io/v1",apiKeyUrl:"platform.minimaxi.com",models:[{id:"MiniMax-M2.1",name:"MiniMax M2.1",contextLength:204e3,supportsVision:!1},{id:"MiniMax-Text-01",name:"MiniMax-Text-01",contextLength:4e6,supportsVision:!1}]},deepseek:{name:"DeepSeek",baseUrl:"https://api.deepseek.com",apiKeyUrl:"platform.deepseek.com",models:[{id:"deepseek-chat",name:"DeepSeek Chat (V3.2)",contextLength:128e3,supportsVision:!1},{id:"deepseek-reasoner",name:"DeepSeek Reasoner (V3.2)",contextLength:128e3,supportsVision:!1}]},qwen:{name:"Qwen (Alibaba)",baseUrl:"https://dashscope-intl.aliyuncs.com/compatible-mode/v1",apiKeyUrl:"dashscope.console.aliyun.com",models:[{id:"qwen3-max",name:"Qwen3 Max",contextLength:131072,supportsVision:!1},{id:"qwen-plus",name:"Qwen Plus",contextLength:131072,supportsVision:!1},{id:"qwen3-coder-plus",name:"Qwen3 Coder Plus",contextLength:1048576,supportsVision:!1}]},anthropic:{name:"Anthropic",baseUrl:"https://api.anthropic.com/v1",apiKeyUrl:"console.anthropic.com",models:[{id:"claude-opus-4-6",name:"Claude Opus 4.6",contextLength:2e5,supportsVision:!0},{id:"claude-sonnet-4-5",name:"Claude Sonnet 4.5",contextLength:2e5,supportsVision:!0},{id:"claude-haiku-4-5",name:"Claude Haiku 4.5",contextLength:2e5,supportsVision:!0}]},custom:{name:"Custom",baseUrl:"",models:[]}},c={zhipu:[{label:"International Standard",url:"https://api.z.ai/api/paas/v4"},{label:"International Coding Plan",url:"https://api.z.ai/api/coding/paas/v4"},{label:"China Standard",url:"https://open.bigmodel.cn/api/paas/v4"},{label:"China Coding Plan",url:"https://open.bigmodel.cn/api/coding/paas/v4"}],openai:[{label:"OpenAI",url:"https://api.openai.com/v1"},{label:"OpenRouter",url:"https://openrouter.ai/api/v1"}],gemini:[{label:"Google AI Studio",url:"https://generativelanguage.googleapis.com/v1beta/openai"},{label:"OpenRouter",url:"https://openrouter.ai/api/v1"}],kimi:[{label:"Moonshot",url:"https://api.moonshot.ai/v1"},{label:"OpenRouter",url:"https://openrouter.ai/api/v1"}],minimax:[{label:"MiniMax",url:"https://api.minimax.io/v1"},{label:"OpenRouter",url:"https://openrouter.ai/api/v1"}],deepseek:[{label:"DeepSeek",url:"https://api.deepseek.com"},{label:"OpenRouter",url:"https://openrouter.ai/api/v1"}],qwen:[{label:"Alibaba Cloud (Intl)",url:"https://dashscope-intl.aliyuncs.com/compatible-mode/v1"},{label:"Alibaba Cloud (China)",url:"https://dashscope.aliyuncs.com/compatible-mode/v1"},{label:"OpenRouter",url:"https://openrouter.ai/api/v1"}],anthropic:[{label:"Anthropic",url:"https://api.anthropic.com/v1"},{label:"OpenRouter",url:"https://openrouter.ai/api/v1"}]};function u(i,t){var e;return(e=t.baseUrls)!=null&&e[i]?t.baseUrls[i]:i==="custom"?t.customBaseUrl:a[i].baseUrl}function m(i,t){return i==="custom"?t.customModelId?[{id:t.customModelId,name:t.customModelId,contextLength:128e3,supportsVision:!1}]:[]:a[i].models}const d=`You are a browser automation agent that helps users by controlling a web browser.

Follow this workflow for every task:

1. PLAN — Before calling any tool, share a 2-3 bullet plan.
2. EXECUTE — Carry out the plan using tools.
3. REPORT — When done, STOP calling tools and write a clear answer to the user's question. You MUST always end with a text response that answers the user. Never finish silently.

IMPORTANT: Your final message MUST contain your answer in plain text. If the user asked a question, answer it. If they asked you to do something, confirm what you did. Never end with an empty message.

Available tools:
- navigate(url): Go to a URL
- read_page(filter): Get page elements. Returns an accessibility tree with ref_ids you can use in click/type_text.
- click(ref_id): Click an element by its ref_id
- type_text(ref_id, text): Type into an input field by its ref_id
- scroll(direction): Scroll up or down on the page

RULES:
- After navigating, call read_page to see elements and find ref_ids before clicking.
- Be efficient — if an action fails or yields no useful result, try a different approach instead of repeating it.
- When you have enough information to answer the user, stop and respond with the answer. Do not keep calling tools.
- Do NOT call read_page or screenshot more than twice in a row without making progress. If you're stuck, try a different approach or navigate to a different URL.`,h=[{type:"function",function:{name:"click",description:"Click on an element identified by ref_id from the accessibility tree",parameters:{type:"object",properties:{ref_id:{type:"string",description:"Element reference ID from the accessibility tree"},click_type:{type:"string",enum:["left","right","double"],description:"Type of click"}},required:["ref_id"]}}},{type:"function",function:{name:"type_text",description:"Type text into an input field identified by ref_id",parameters:{type:"object",properties:{ref_id:{type:"string",description:"Element reference ID"},text:{type:"string",description:"Text to type"}},required:["ref_id","text"]}}},{type:"function",function:{name:"navigate",description:"Navigate to a URL in the current tab",parameters:{type:"object",properties:{url:{type:"string",description:"URL to navigate to"}},required:["url"]}}},{type:"function",function:{name:"screenshot",description:"Take a screenshot of the current page for visual analysis. Use this when you need to see the page layout.",parameters:{type:"object",properties:{full_page:{type:"boolean",description:"Whether to capture the full page or just visible area"}}}}},{type:"function",function:{name:"read_page",description:"Get the accessibility tree of the current page. This shows all interactive elements with their ref_ids.",parameters:{type:"object",properties:{filter:{type:"string",enum:["all","interactive"],description:"Filter to show all elements or only interactive ones"}}}}},{type:"function",function:{name:"scroll",description:"Scroll the page in a direction",parameters:{type:"object",properties:{direction:{type:"string",enum:["up","down"],description:"Scroll direction"},amount:{type:"number",description:"Pixels to scroll (default: 500)"}},required:["direction"]}}}],n={SETTINGS:"tb_settings",CONVERSATIONS:"tb_conversations"},p={apiKey:"",provider:"zhipu",apiKeys:{},baseUrls:{},customBaseUrl:"",customModelId:"",defaultModel:"glm-4.7",permissionLevel:"ask",allowedSites:[],language:"en",maxIterations:30,enableNudgeSystem:!1};async function s(){const t=(await chrome.storage.local.get(n.SETTINGS))[n.SETTINGS]||{},e={...p,...t};let o=!1;return e.apiKey&&(!e.apiKeys||!Object.keys(e.apiKeys).length)&&(e.apiKeys={zhipu:e.apiKey},e.apiKey="",o=!0),e.customBaseUrl&&(!e.baseUrls||!e.baseUrls.custom)&&(e.baseUrls={...e.baseUrls,custom:e.customBaseUrl},o=!0),o&&await chrome.storage.local.set({[n.SETTINGS]:e}),e}async function g(i){const e={...await s(),...i};await chrome.storage.local.set({[n.SETTINGS]:e})}async function f(i){const t=await s(),e=i||t.provider;return t.apiKeys[e]?t.apiKeys[e]:""}async function l(){return(await chrome.storage.local.get(n.CONVERSATIONS))[n.CONVERSATIONS]||[]}async function y(i){const t=await l(),e=t.findIndex(r=>r.id===i.id);e>=0?t[e]=i:t.unshift(i);const o=t.slice(0,50);await chrome.storage.local.set({[n.CONVERSATIONS]:o})}function b(){return`${Date.now()}-${Math.random().toString(36).slice(2,11)}`}export{h as B,d as D,a as P,s as a,f as b,c,m as d,g as e,u as f,b as g,y as s};
